{"version":3,"file":"StoryPoint.js","sourceRoot":"","sources":["../../../../src/EmbeddingApi/Models/StoryPoint.ts"],"names":[],"mappings":";;;;;;;;;AAAA,4EAA8D;AAC9D,0DAAoG;AAEpG,2CAAwC;AACxC,mCAAgC;AAChC,2CAAwC;AAExC,MAAa,UAAU;IACrB,YAAoB,eAA+B,EAAU,aAAoC;QAA7E,oBAAe,GAAf,eAAe,CAAgB;QAAU,kBAAa,GAAb,aAAa,CAAuB;IAAG,CAAC;IAErG,IAAW,KAAK;QACd,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;IACpC,CAAC;IAED,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC;IACtC,CAAC;IAED,IAAW,MAAM;QACf,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;IACrC,CAAC;IAED,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC;IACtC,CAAC;IAED,IAAW,cAAc;QACvB,MAAM,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC;QAC3D,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,SAAS,CAAC;SAClB;QAED,QAAQ,cAAc,CAAC,SAAS,EAAE;YAChC,KAAK,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;gBACjC,OAAO,IAAI,qBAAS,CAAC,cAA+B,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;aAC3E;YACD,KAAK,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;gBACjC,OAAO,IAAI,qBAAS,CAAC,cAA+B,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;aAC3E;YACD,KAAK,QAAQ,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;gBAC7B,MAAM,IAAI,4BAAY,CAAC,QAAQ,CAAC,mBAAmB,CAAC,mBAAmB,EAAE,sCAAsC,CAAC,CAAC;aAClH;YACD,OAAO,CAAC,CAAC;gBACP,MAAM,IAAI,4BAAY,CAAC,QAAQ,CAAC,mBAAmB,CAAC,mBAAmB,EAAE,sCAAsC,CAAC,CAAC;aAClH;SACF;IACH,CAAC;IAED,IAAW,WAAW;QACpB,OAAO,IAAI,aAAK,CAAC,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;IACzE,CAAC;CACF;AA5CD,gCA4CC","sourcesContent":["import * as Contract from '@tableau/api-external-contract-js';\nimport { DashboardImpl, StoryPointImpl, TableauError, WorksheetImpl } from '@tableau/api-shared-js';\nimport { EmbeddingWorkbookImpl } from '../Impl/EmbeddingWorkbookImpl';\nimport { Dashboard } from './Dashboard';\nimport { Story } from './Story';\nimport { Worksheet } from './Worksheet';\n\nexport class StoryPoint implements Contract.StoryPoint {\n  constructor(private _storyPointImpl: StoryPointImpl, private _workbookImpl: EmbeddingWorkbookImpl) {}\n\n  public get index(): number {\n    return this._storyPointImpl.index;\n  }\n\n  public get caption(): string {\n    return this._storyPointImpl.caption;\n  }\n\n  public get active(): boolean {\n    return this._storyPointImpl.active;\n  }\n\n  public get updated(): boolean {\n    return this._storyPointImpl.updated;\n  }\n\n  public get containedSheet(): Contract.EmbeddingSheet | undefined {\n    const containedSheet = this._storyPointImpl.containedSheet;\n    if (!containedSheet) {\n      return undefined;\n    }\n\n    switch (containedSheet.sheetType) {\n      case Contract.SheetType.Worksheet: {\n        return new Worksheet(containedSheet as WorksheetImpl, this._workbookImpl);\n      }\n      case Contract.SheetType.Dashboard: {\n        return new Dashboard(containedSheet as DashboardImpl, this._workbookImpl);\n      }\n      case Contract.SheetType.Story: {\n        throw new TableauError(Contract.EmbeddingErrorCodes.ImplementationError, 'A story cannot contain another story');\n      }\n      default: {\n        throw new TableauError(Contract.EmbeddingErrorCodes.ImplementationError, 'Unable to initialize contained sheet');\n      }\n    }\n  }\n\n  public get parentStory(): Contract.Story {\n    return new Story(this._storyPointImpl.parentStory, this._workbookImpl);\n  }\n}\n"]}